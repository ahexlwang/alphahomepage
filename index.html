<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI pharmacy ALPHA</title>
  <link rel="stylesheet" href="style/stylev1.1.css" />
</head>
<body>

  <div class="wrap">
    <!-- Header -->
    <header class="block">
      <img src="image/logo.png" alt="ALPHA 로고" class="logo">
    </header>

    <!-- Nav -->
    <nav class="block main-nav">
      <ul>
        <li><a href="activities.html">Activity</a></li>
        <li><a href="project.html">Project</a></li>
        <li><a href="member.html">Member</a></li>
        <li><a href="join.html">Join Us</a></li>
      </ul>
    </nav>


<main>
  <section class="protein" aria-label="protein">
  <div id="protein-viewer"></div>
  </section>




  <section class="about" aria-label="join">
    <h2>AI Pharmacy ALPHA</h2>
    <p>서울대 약학대학 딥러닝 동아리 ALPHA는<br>
     AI에 관심 있는 누구나 함께할 수 있는 열린 공간입니다.</p>
    <a href="contact.html" class="join-btn">Join Us</a>
    </section>
</main>


    <footer class="block">
      <p>서울대학교 약학대학 · 010-1234-5678</p>
    </footer>
  </div>

<!-- Three.js & TrackballControls (CDN) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/TrackballControls.js"></script>

<script>
  const container = document.getElementById("protein-viewer");

  // Scene / Camera
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0xffffff);

  const camera = new THREE.PerspectiveCamera(
    60,
    container.clientWidth / container.clientHeight,
    0.1, 1000
  );
  camera.position.set(0, 0, 25);
  camera.lookAt(0, 0, 0);

  // Renderer
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(container.clientWidth, container.clientHeight);
  container.appendChild(renderer.domElement);

  // Lights
  const dir = new THREE.DirectionalLight(0xffffff, 1);
  dir.position.set(5, 5, 10);
  scene.add(dir);
  scene.add(new THREE.AmbientLight(0x999999));

  // Controls (마우스로 360° 자유 회전)
  const controls = new THREE.TrackballControls(camera, renderer.domElement);
  controls.rotateSpeed = 4.0;
  controls.zoomSpeed   = 1.2;
  controls.panSpeed    = 0.8;
  controls.noPan = true; // 중심 고정
  controls.dynamicDampingFactor = 0.2;
  controls.target.set(0, 0, 0); // 회전 중심 = 원점

  // ========= Helix 생성 (다이아몬드 나선) =========
  const helix = new THREE.Group();
  const diamondGeo = new THREE.OctahedronGeometry(0.4);
  const turns = 4, points = 80, radius = 3, pitch = 0.25;

  for (let i = 0; i < points; i++) {
    const t = i / points;
    const theta = turns * Math.PI * 2 * t;
    const x = radius * Math.cos(theta);
    const y = pitch * i;
    const z = radius * Math.sin(theta);

    const hue = Math.random() * 360;
    const mat = new THREE.MeshPhongMaterial({ color: new THREE.Color(`hsl(${hue}, 70%, 60%)`) });
    const d = new THREE.Mesh(diamondGeo, mat);
    d.position.set(x, y, z);
    helix.add(d);
  }

  // ✅ 정확 중심 정렬: 박스 경계로 실제 중심점을 계산해 원점에 맞춤
  const box = new THREE.Box3().setFromObject(helix);
  const center = box.getCenter(new THREE.Vector3());
  helix.position.sub(center); // 헬릭스의 기하학적 중심을 (0,0,0)에 두기

  // ✅ 자동 회전은 'pivot' 그룹(원점)에 붙여서 축 일치
  const pivot = new THREE.Group(); // 원점(0,0,0)
  pivot.add(helix);
  scene.add(pivot);

  // 자동 회전 각속도 (랜덤 축, 원점 기준)
  const omega = new THREE.Vector3(
    (Math.random()*0.006 + 0.003) * (Math.random() < 0.5 ? -1 : 1),
    (Math.random()*0.006 + 0.003) * (Math.random() < 0.5 ? -1 : 1),
    (Math.random()*0.006 + 0.003) * (Math.random() < 0.5 ? -1 : 1)
  );

  // 사용자 조작 시 자동 회전 일시 정지 → 잠시 후 재개
  let userInteracting = false, idleTimer = null;
  const pauseAuto   = () => { userInteracting = true;  if (idleTimer) clearTimeout(idleTimer); };
  const resumeAuto  = () => { if (idleTimer) clearTimeout(idleTimer); idleTimer = setTimeout(() => userInteracting = false, 1200); };
  controls.addEventListener('start', pauseAuto);
  controls.addEventListener('end',   resumeAuto);

  // Loop
  function animate() {
    requestAnimationFrame(animate);

    if (!userInteracting) {
      // ✅ 헬릭스 '전체'가 원점을 축으로 회전
      pivot.rotation.x += omega.x;
      pivot.rotation.y += omega.y;
      pivot.rotation.z += omega.z;
    }

    controls.update();
    renderer.render(scene, camera);
  }
  animate();

  // Resize
  window.addEventListener("resize", () => {
    const w = container.clientWidth, h = container.clientHeight;
    camera.aspect = w / h;
    camera.updateProjectionMatrix();
    renderer.setSize(w, h);
    controls.handleResize();
  });
</script>


</body>


</html>
